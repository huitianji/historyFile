$(function(){function t(){""!=o("syd_name")&&""==o("ydt_freshman_guide")&&$.post("/myaccount/fixedmonth/fixedMonthStatus",{time:(new Date).getTime()},function(t){t.data&&2==t.data||(e(),i("ydt_freshman_guide","1",365))},"json")}function e(){var t=document.getElementById("ydt_floats"),e=$(".ydt_dredge"),a=$(".ydt_floats_close");t.style.display="block",e[0].style.opacity="0",e[0].style.filter="alpha(opacity:0)",e.show();var i=$(window).height(),o=$(window).width(),s=$(window).scrollTop();s=0;var r=(i-e.height())/2+s,l=(o-e.width())/2;e.css({top:r+"px",left:l+"px"}),n(e[0],{opacity:100},{}),a.on("click",function(a,i){n(t,{opacity:0},{time:400}),n(e[0],{opacity:0},{time:400,succFn:function(){e.hide(),$(t).hide(),i&&i()}})})}function a(t,e){return t.currentStyle?t.currentStyle[e]:getComputedStyle(t,!1)[e]}function n(t,e,n){n=n||{},n.type=n.type||"linear",n.time=n.time||800;var i=Math.round(n.time/30),o={},s={};for(var r in e){if("opacity"==r?(o[r]=Math.round(parseFloat(100*a(t,r))),isNaN(o[r])&&(o[r]=100)):o[r]=parseInt(a(t,r)),!o[r])switch(r){case"left":o[r]=t.offsetLeft;break;case"top":o[r]=t.offsetTop;break;case"width":o[r]=t.offsetWidth;break;case"height":o[r]=t.offsetHeight}s[r]=e[r]-o[r]}var l=0;clearInterval(t.timer),t.timer=setInterval(function(){l++;for(var a in e){switch(n.type){case"linear":var r=l/i,c=o[a]+s[a]*r;break;case"ease-in":var r=l/i,c=o[a]+s[a]*r*r*r;break;case"ease-out":var r=1-l/i,c=o[a]+s[a]*(1-r*r*r)}"opacity"==a?(t.style.opacity=c/100,t.style.filter="alpha(opacity:"+c+")"):t.style[a]=c+"px"}l==i&&(clearInterval(t.timer),n.succFn&&n.succFn())},30)}function i(t,e,a){if(a){var n=new Date;n.setDate(n.getDate()+a),document.cookie=t+"="+e+";path=/;expires="+n}}function o(t){for(var e=document.cookie.split("; "),a=0,n=e.length;n>a;a++){var i=e[a].split("=");if(i[0]==t)return i[1]}return""}function s(){var t,e=location.search,a=new Object;if(-1!=e.indexOf("?")){var n=e.substr(1);t=n.split("&");for(var i=0;i<t.length;i++)a[t[i].split("=")[0]]=t[i].split("=")[1]}return a}var r=new Object;r=s(),r.hasOwnProperty("tomc")&&t()}),function(t){"use strict";function e(){var e=document.getElementById("cvs-accview-circular");if(e.getContext){var a=t(".accview-circular-aside .accview-circular-number"),n=e.getContext("2d"),i=["#64b2e9","#ffb324","#81cb50"],o=264,s=246,r=88,l=22,c=o/2,h=s/2,d=1,f=1/120;e.setAttribute("width",o),e.setAttribute("height",s);for(var u=[],m=0,g=0;g<a.length;g++)u.push(1*a.eq(g).attr("data-money")),m+=u[g];var p=0;if(0==m)for(var g=0;g<u.length;g++)u[g]=1/u.length;else{for(var v=[],y=[],g=0;g<u.length;g++)u[g]/m<f?v.push(g):y.push(g);if(2==v.length)u[y[0]]=1-2*f,u[v[0]]=u[v[1]]=f;else if(1==v.length){var w=y[0],D=y[1],$=u[w]+u[D];u[w]=u[w]/$*(1-f),u[D]=u[D]/$*(1-f),u[v[0]]=f}else for(var g=0;g<u.length;g++)u[g]=u[g]/m}for(var g=0;g<u.length;g++){var C=360*u[g],M=0==g?-90:p,b=M+C-d;n.beginPath(),n.arc(c,h,r,M*Math.PI/180,b*Math.PI/180),n.lineWidth=l,n.strokeStyle=i[g],n.stroke(),n.closePath(),p=b+d,n.beginPath(),n.arc(c,h,r,b*Math.PI/180,p*Math.PI/180),n.lineWidth=l,n.strokeStyle="#fff",n.stroke(),n.closePath()}}}var a={fmtMoney:function(t,e,a){return 0!==e&&(e=2|e),t="number"!=typeof parseInt(t)||a?(1*t).toFixed(e):(t/100).toFixed(e),t=(""+t).replace(/(\d)(?=(?:\d{3})+(?:\.\d+)?$)/g,"$1,")},getErrorHtml:function(t){return t=t?t:"",'<span class="accview-load-failed '+t+'">加载失败，<a href="javascript:;" onclick="javascript:window.location.reload();" >立即刷新</a></span>'}};template.helper("fmtMoney",function(t,e,n){return a.fmtMoney(t,e,n)}),t(".acc-view-information").on("click",function(){t(this).prev().find("a:eq(0) .acc-view-picgif-status").click()}),~function(){var e=codes&&codes.local_tooltip;t("[data-text]").each(function(){var a=t(this),n=a.attr("data-text"),i="";e&&e[n]&&(i=e[n]),a.attr("data-text",i)})}(),~function(){function e(e){t.ajax({url:"/myaccount/portal/ajax/get_my_invest/"+e,type:"POST",data:{type:e},dataType:"json"}).done(function(a){if(0==a.errorCode){var n="fund"==e?"myProjectFund":"myProject",i=template("src_overview/"+n,a.data);t(".acc-view-information[data-type='project-"+e+"']").html(i)}}).fail(function(){t(".acc-view-information[data-type='project-"+e+"']").closest(".acc-view-item").html(a.getErrorHtml("line-height98"))})}for(var n=["normal","transfer","dqb","fund"],i=0;i<n.length;i++)e(n[i])}(),~function(){function n(){t.ajax({url:"/myaccount/portal/ajax/get_my_invest/capital",type:"POST",dataType:"json",data:{t:Math.random()}}).done(function(n){0==n.errorCode&&(i(n.data),t(".acc-view-calendar").find("em[data-type='calender-total']").html(a.fmtMoney(n.data.willGainInterest+n.data.willGainPrincipal,2)),setTimeout(e,50))}).fail(function(){t(".acc-view-amount-change").html(a.getErrorHtml())})}function i(e){for(var n in e){var i=t("#"+n),o=t.trim(i.html()),s=a.fmtMoney(e[n],2)+"";""==o?i.html(s):i.html(o.replace("0.00",s)),i.filter("[data-money]").attr("data-money",e[n]/100)}}n()}(),window.mysyd=function(){alert("syd")},~function(){function e(t){var e=t.attr("src");t.attr("src",t.attr("_src")).attr("_src",e)}function a(){t(this).find(".acc-view-picgif-name").css("color","#53a0e3"),AnimationJs.startMove(t(this).find(".acc-view-information").get(0),{marginLeft:24},{time:200,type:"linear"})}function n(){t(this).find(".acc-view-picgif-name").css("color",""),AnimationJs.startMove(t(this).find(".acc-view-information").get(0),{marginLeft:34},{time:200,type:"linear"})}function i(t){var e,a=["webkit","Moz","ms","o"],n=[],i=document.documentElement.style,o=function(t){return t.replace(/-(\w)/g,function(t,e){return e.toUpperCase()})};for(e in a)n.push(o(a[e]+"-"+t));n.push(o(t));for(e in n)if(n[e]in i)return!0;return!1}var o=i("transition");return 1==o?(t(".acc-view-item").on("mouseenter mouseleave",function(){t(this).toggleClass("mouseenter"),e(t(this).find(".acc-view-picgif-hover img"))}),void 0):(t(".acc-view-item").on("mouseenter",function(){e(t(this).find(".acc-view-picgif-default img")),t.proxy(a,this)()}).on("mouseleave",function(){e(t(this).find(".acc-view-picgif-default img")),t.proxy(n,this)()}),void 0)}(),~function(){function e(){t.ajax({url:"/myaccount/portal/ajax/get_receipt_month",type:"POST",dataType:"json",data:{t:Math.random()}}).done(function(e){if(0==e.errorCode){for(var o="",s=t("#cal-left-totalMonth"),r=0;r<e.data.length;r++){var l=e.data[r];o+='<a href="javascript:;"><em>'+a.fmtMoney(l.amount,2)+"</em><span>"+l.monthStr+"</span></a>"}if(""!=o)s.html(o),i();else{o='<div class="accview-debt-collection"><span>没有回款</span><span class="accview-debt-btns"><input type="button" class="version-btn-h30" data-type="version-btn-invest" value="立即投资"></span></div>',s.parent().append(t(o)),s.remove();var c=new n("invest-calender");c.setCalender(c.today.getMonth()+1)}}}).fail(function(){t(".acc-view-calendar").html(a.getErrorHtml("line-height403"))})}function n(e){if(this.$oCalender=t("#"+e),this.nowDate=new Date,this.today=new Date,this.iNow=0,this.$leftTotal=t("#cal-left-totalMonth"),this.$arrLeftMonth=this.$leftTotal.find("a"),this.$position=this.$oCalender.closest(".accview-calendar-poistionab"),this.$oLast=t("#cal-last-month"),this.$oNext=t("#cal-next-month"),this.dayNum=0,this.isFront=!1,this.clickDate=0,this.isNextDate=!1,this.cacheMonthData={},this.cacheDateData={},this.$leftTotal.length){var a=this.$leftTotal.find("a:eq(0) span").html(),n=a.split("-");this.nowDate.setFullYear(n[0],n[1]-1),this.$arrLeftMonth.eq(this.iNow).addClass("current")}}function i(){var e=document.getElementById("cal-left-totalMonth").getElementsByTagName("a"),a=new n("invest-calender");a.setCalender();var i=document.getElementById("cal-last-month"),o=document.getElementById("cal-next-month");i.onclick=function(){a.setLastMonth()},o.onclick=function(){a.setNextMonth()};for(var s=0;s<e.length;s++)e[s].onclick=function(){var e=this.getElementsByTagName("span"),n=t.trim(e[0].innerHTML).split("-");(a.nowDate.getMonth()!=n[1]-1||a.nowDate.getFullYear()!=n[0])&&a.setCalender(parseInt(n[1],10),n[0])};t(".accview-calendar-fixed").on("click","li a",function(){var e=t(this),n=e.closest("li"),i=t("#invest-calender").find("li").children("a.today").parent(),o=t("#invest-calender").find('a[class="today"]'),s=n.attr("data-date"),r=n.attr("data-month"),l=n.attr("data-year");i.length&&r==i.attr("data-month")&&s==i.attr("data-date")||(o.removeClass("today"),"true"==o.attr("data-border")&&o.addClass("border"),e[0].className="today",a.clickDateFn({date:s,month:r,year:l},parseInt(s)>parseInt(i.attr("data-date"))?!0:!1))})}t(".acc-view-calendar").on("click","input[data-type='version-btn-invest']",function(){window.location.href="/invest"}),e(),n.prototype={setNextMonth:function(){this.setMonth(this.nowDate.getMonth()+1),this.setCalender()},setLastMonth:function(){this.setMonth(this.nowDate.getMonth()-1),this.setCalender()},setMonth:function(t,e){var a=this.iNow,n=12*this.nowDate.getFullYear()+this.nowDate.getMonth(),i=t;i+=e?12*e:12*this.nowDate.getFullYear();var o=i-n;this.isFront=o>=0?!0:!1,this.iNow+=o,this.setLeftClassToTotalData(a),e&&this.nowDate.setFullYear(e),this.nowDate.setMonth(t)},setLeftClassToTotalData:function(t){this.$arrLeftMonth.eq(t).removeClass("current"),this.$arrLeftMonth.eq(this.iNow).addClass("current");var e=this.$arrLeftMonth.eq(0).outerHeight(!0),a=this.$leftTotal.scrollTop(),n=this.iNow+1;10>=n?a>e*(n-1)&&this.$leftTotal.scrollTop((n-1)*e):e*(n-10)>a?this.$leftTotal.scrollTop(e*(n-10)):a>e*(n-1)&&this.$leftTotal.scrollTop(e*(n-1))},getWeekDay:function(t){var e=this.clone(t);return e.setDate(1),e.getDay()},getLastDate:function(t){var e=this.clone(t);return e.setMonth(e.getMonth()+1),e.setDate(0),e},getLastMonthLastDay:function(t){var e=this.clone(t);return e.setDate(0),e.getDate()},setCalender:function(e,a){this.dayNum=0;var n=["7","1","2","3","4","5","6"],i=[],o=t("<div>").html(this.$position.html()).addClass(this.$position.attr("class"));e&&this.setMonth(e-1,a);var s=n[this.getWeekDay(this.nowDate)],r=this.getLastDate(this.nowDate),l=r.getDate(),c=n[r.getDay()],h=this.getLastMonthLastDay(this.nowDate);i.push(this.createArrLi({start:h-(s-1)+1,end:h,commonLiHtml:"<span>@value</span>",weekLiHtml:"<em>@value</em>"}));var d=42-(s-1)-l,f=this.clone(this.nowDate);f.setDate(1);var u=this.clone(this.nowDate);u.setMonth(u.getMonth()+1),u.setDate(d);var m=this.getMonthData(f.getTime(),u.getTime()),g=this;i.push(this.createArrLi({start:1,end:l,weekDay:s-1,month:12==g.nowDate.getMonth()?0:g.nowDate.getMonth(),commonLiHtml:"<a href='javascript:;' class='@hrefClass'>@value</a>",weekLiHtml:"<a href='javascript:;' class='@hrefClass'><strong>@value</strong></a>"})),i.push(this.createArrLi({start:1,end:d,weekDay:c,month:12==g.nowDate.getMonth()+1?0:g.nowDate.getMonth()+1,year:g.nowDate.getFullYear()+1,commonLiHtml:"<a href='javascript:;' class='@hrefClass'><span>@value</span></a>",weekLiHtml:"<a href='javascript:;' class='@hrefClass'><em>@value</em></a>"})),this.$oCalender.html(i.join("")),document.getElementById("invest-cal-month").innerHTML=this.nowDate.getFullYear()+"-"+this.addZero(this.nowDate.getMonth()+1),this.setClassToDay(m),this.isHasClickBtn(),this.$position.find(".accview-calendar-title em").html(this.$leftTotal.find(".current em").html());var p=this.$position.width(),v=this.isFront?p:-p;this.$position.css("left",v+"px"),t(o).css("left",0).appendTo(this.$position.parent()),AnimationJs.startMove(this.$position[0],{left:0},{time:600,type:"ease-out"}),AnimationJs.startMove(t(o)[0],{left:-v},{time:600,type:"ease-out",succFn:function(){t(o).remove(),g.clickDateFn({date:g.nowDate.getDate(),month:g.nowDate.getMonth(),year:g.nowDate.getFullYear()},g.isFront),0==g.$oCalender.find("li[data-month]").find("a.border").length?t(".accview-daycollect .accview-debt-collection span:eq(0)").html("当月没有回款"):t(".accview-daycollect .accview-debt-collection span:eq(0)").html("当日没有回款")}})},setClassToDay:function(t){for(var e=this.$oCalender.find("li[data-month]"),a=this.today.getMonth(),n=this.today.getDate(),i=this.today.getFullYear(),o=!1,s=0;s<e.length;s++){var r=e.eq(s),l=r.find("a"),c=r.attr("data-month"),h=r.attr("data-date"),d=r.attr("data-year");if(!t||!t.data)break;for(var f=0;f<t.data.length;f++){var u=new Date(t.data[f]),m=u.getMonth(),g=u.getDate();if(m==c&&g==h){l.attr("data-border","true").addClass("border");break}}this.isNextDate||o||c!=a||h!=n||d!=i||(l.removeClass().addClass("today"),this.nowDate.setDate(h),o=!0)}if(!this.isNextDate&&!o){var p=e.find("a.border").eq(0);p.length&&(this.nowDate.setDate(p.parent().attr("data-date")),p.removeClass().addClass("today"))}},isHasClickBtn:function(){var t=this.$oLast.parent(),e=this.$oNext.parent(),a=this.nowDate.getMonth(),n=this.nowDate.getFullYear(),i=this.today.getMonth(),o=this.today.getFullYear();if(this.$arrLeftMonth.length)var s=this.$arrLeftMonth.last().find("span").html().split("-"),r=s[0],l=s[1];else var r=0;if(this.$leftTotal.length){var c=this.$leftTotal.find("a:eq(0) span").html(),h=c.split("-");i=h[1]-1,o=h[0]}a==i&&n==o?t.hide():t.show(),0==r||a==parseInt(l)-1&&n==r?e.hide():e.show()},clickDateFn:function(t,e){if(!(0!=this.clickDate||t.month>this.nowDate.getMonth()&&!this.$oNext.is(":visible")))if(0==t.month&&11==this.nowDate.getMonth()||t.month>this.nowDate.getMonth())this.nowDate.setDate(t.date),this.isNextDate=!0,this.setNextMonth();else{this.clickDate=t.date,this.isNextDate&&this.$oCalender.find("li[data-month]").filter("[data-date="+this.clickDate+"]").eq(0).find("a").removeClass().addClass("today"),this.isNextDate=!1;var a=new Date(t.year,t.month,t.date),n=this.getDateData(a);this.setDataToDay(n,e)}},setDataToDay:function(e,n){var i=t("#cal-date-receive"),o=i.attr("data-length")||"0",s=!e.data.list.length,r=e.data&&e.data.total||0,l=254;0==e.data.total&&(s=!0);var c="<div class='accview-positionab'>";c+='     <span class="accview-daycoll-title">',c+="         <em>"+a.fmtMoney(r,2)+"</em>",c+="         <span>日待收</span>",c+="     </span>",c+='     <span class="accview-daycoll-title gray">',c+="         <em>待收回款</em>",c+="         <span>项目编号</span>",c+="     </span>",c+="</div>";var h=t(c);if(s){if("0"==o)return this.clickDate=0,void 0;if("1"==o){i.attr("data-length",0);var d="<div class='accview-debt-collection'>";d+='<span>当日没有回款</span><span class="accview-debt-btns"><input type="button" class="version-btn-h30" data-type="version-btn-invest" value="立即投资"></span>',d+="</div>"}}else{i.attr("data-length",1);for(var d="<div class='accview-daycoll-list'>",f=0;f<e.data.list.length;f++){var u=e.data.list[f],m=0==u.productType?"/bid/detail/":"/fb/detail/",g=a.fmtMoney(u.principal+u.interest+u.subsidyPrincipal+u.subsidyInterest+u.raiseInterest+u.actualRaiseInterest,2);d+="<span><em>"+g+'</em><a target="_blank" href="'+m+u.newbidId+'">'+u.title+"</a></span>"}d+="</div>"}var p=i.find(".accview-positionab:eq(0)");h.append(d),i.append(h);var v=n?l:-l;h.css("left",v),p.css("left",0);var y=this;AnimationJs.startMove(h[0],{left:0},{time:600,type:"ease-out"}),AnimationJs.startMove(p[0],{left:-v},{time:600,type:"ease-out",succFn:function(){p.remove(),y.clickDate=0}})},getMonthData:function(e,a){var n=this.cacheMonthData[this.nowDate.getFullYear()+""+this.addZero(this.nowDate.getMonth())];if(n)return n;var i=this;return t.ajax({url:"/myaccount/portal/ajax/get_receipt_days",type:"POST",dataType:"json",async:!1,data:{begin:e,end:a}}).done(function(t){0==t.errorCode&&(i.cacheMonthData[i.nowDate.getFullYear()+""+i.addZero(i.nowDate.getMonth())]=t)}),this.cacheMonthData[this.nowDate.getFullYear()+""+this.addZero(this.nowDate.getMonth())]},getDateData:function(e){var a=this.cacheDateData[e.getFullYear()+""+this.addZero(e.getMonth())+this.addZero(e.getDate())];if(a)return a;var n=this;return t.ajax({url:"/myaccount/portal/ajax/get_day_receipt",type:"POST",dataType:"json",async:!1,data:{date:e.getTime()}}).done(function(t){0==t.errorCode&&(n.cacheDateData[e.getFullYear()+""+n.addZero(e.getMonth())+n.addZero(e.getDate())]=t)}),this.cacheDateData[e.getFullYear()+""+this.addZero(e.getMonth())+this.addZero(e.getDate())]},createArrLi:function(t){for(var e=t.weekDay||0,a=[],n=t.year||this.nowDate.getFullYear(),i=t.start;i<=t.end;i++){var o={value:i,liHtml:t.commonLiHtml,year:n,month:t.month};this.dayNum++,e++,(6==e||7==e)&&(7==e&&(e=0),o.liHtml=t.weekLiHtml||o.liHtml),t.everyFn&&t.everyFn(o),a.push(this.createLi(o))}return a.join("")},createLi:function(t){var e=void 0!=t.month?" data-month="+t.month:"",a=t.hrefClass||"",n="<li "+e+" data-date="+t.value+" data-year="+t.year+">"+t.liHtml.replace(/@value/,t.value).replace(/@hrefClass/,a)+"</li>";return n},clone:function(t){return new Date(t.getTime())},addZero:function(t){return 10>t?"0"+t:t},constructor:n}}(),~function(){require.config({paths:{echarts:"https://static.souyidai.com/www/js/echartsJs"}}),require(["echarts","echarts/chart/line"],function(e){var n=e.init(document.getElementById("echarts-profit")),i={title:{show:!1,text:"",subtext:"",textStyle:{fontSize:"12",fontWeight:"normal"}},tooltip:{trigger:"axis",textStyle:{fontSize:"12",color:"#fff"},formatter:function(t){var e=a.fmtMoney(t[0].value,2,!0);return t[0].name+"<br>"+"收益："+e+"元"}},legend:{show:!1,data:["搜易贷收益走势图"]},toolbox:{show:!1,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["line","bar"]},restore:{show:!0},saveAsImage:{show:!0}}},grid:{x:"16",x2:"16",y:"16",y2:"40",borderColor:"#fff"},calculable:!0,dataZoom:{show:!0,start:67,end:100,fillerColor:"#ffb224",handleSize:8,height:12,backgroundColor:"#ececec",zoomLock:!1},xAxis:[{type:"category",boundaryGap:!1,data:[],splitLine:{show:!1}}],yAxis:[{type:"value",axisLabel:{margin:"-30"},splitArea:{show:!0,areaStyle:{color:["rgba(255,255,255,1)","rgba(247,247,247,1)"]}},splitLine:{lineStyle:{color:["#eee"],width:1,type:"solid"}}}],series:[{name:"收益",type:"line",data:[],axisLabel:{formatter:function(t){return a.fmtMoney(t,2,!0)}}}]};i.xAxis[0].data=[],i.series[0].data=[],t.ajax({url:"/myaccount/portal/ajax/get_my_invest/gainAmount90",type:"POST",dataType:"json",data:{t:Math.random()}}).done(function(e){var a=t.parseJSON(e.data&&e.data.graphData);t("#testFor90data").html(e.graphData);for(var o in a)i.xAxis[0].data.push(o.substring(5)),i.series[0].data.push(a[o]/100);n.setOption(i)}).fail(function(){t(".acc-view-graph").html(a.getErrorHtml())})})}()}(jQuery);